## Insert Macro to PPT
### OS: Linux and Windows

```python
import aspose.slides as slides

# Load Presentation
with slides.Presentation("Presentation.pptx") as presentation:
    # Create new VBA Project
    presentation.vba_project = slides.vba.VbaProject()

    # Add empty module to the VBA project
    module = presentation.vba_project.modules.add_empty_module("Module")

    # Set module source code
    module.source_code = "Option Explicit" "Sub AddElements()" \
                         "Dim shp As Shape" \
                         "Dim i As Integer, n As Integer" \
                         "n = ActivePresentation.Slides.Count" \
                         "For i = 1 To n" \
                         "Dim s As Slide" \
                         "Set s = ActivePresentation.Slides(i)" \
                         "s.SlideShowTransition.Hidden = msoTrue" \
                         "Dim max As Integer: max = AnimationElements(s)" \
                         "Dim k As Integer, s2 As Slide" \
                         "For k = 1 To max" \
                         "Set s2 = s.Duplicate(1)" \
                         "s2.Name = 'AutoGenerated: ' & s2.SlideID" \
                         "s2.SlideShowTransition.Hidden = msoFalse" \
                         "Dim oshp As Shape" \
                         "With s2.Shapes" \
                         "Set oshp = .AddTextbox(msoTextOrientationHorizontal, 905, 510, 100, 50)" \
                         "oshp.TextFrame.TextRange.Font.Name = 'Times New Roman'" \
                         "oshp.TextFrame.TextRange.Font.Size = 12" \
                         "oshp.TextFrame.TextRange.InsertAfter "" & i" \
                         "End With" \
                         "s2.MoveTo ActivePresentation.Slides.Count" \
                         "Dim i2 As Integer, h As Shape" \
                         "Dim Del As New Collection" \
                         "For i2 = s2.Shapes.Count To 1 Step -1" \
                         "Set h = s2.Shapes(i2)" \
                         "If Not IsVisible(s2, h, k) Then Del.Add h" \
                         "Next" \
                         "Dim j As Integer" \
                         "For j = s.TimeLine.MainSequence.Count To 1 Step -1" \
                         "s2.TimeLine.MainSequence.Item(1).Delete" \
                         "Next" \
                         "For j = Del.Count To 1 Step -1" \
                         "Del(j).Delete" \
                         "Del.Remove j" \
                         "Next" \
                         "Next" \
                         "Next" \
                         "End Sub" \
                         "Function IsVisible(s As Slide, h As Shape, i As Integer) As Boolean" \
                         "Dim e As Effect" \
                         "IsVisible = True" \
                         "For Each e In s.TimeLine.MainSequence" \
                         "If e.Shape Is h Then" \
                         "IsVisible = Not (e.Exit = msoFalse)" \
                         "Exit For" \
                         "End If" \
                         "Next" \
                         "Dim n As Integer: n = 1" \
                         "For Each e In s.TimeLine.MainSequence" \
                         "If e.Timing.TriggerType = msoAnimTriggerOnPageClick Then n = n + 1" \
                         "If n > i Then Exit For" \
                         "If e.Shape Is h Then IsVisible = (e.Exit = msoFalse)" \
                         "Next" \
                         "End Function" \
                         "Function AnimationElements(s As Slide) As Integer" \
                         "AnimationElements = 1" \
                         "Dim e As Effect" \
                         "For Each e In s.TimeLine.MainSequence" \
                         "If e.Timing.TriggerType = msoAnimTriggerOnPageClick Then" \
                         "AnimationElements = AnimationElements + 1" \
                         "End If" \
                         "Next" \
                         "End Function" \
                         "Sub RemElements()" \
                         "Dim i As Integer, n As Integer" \
                         "Dim s As Slide" \
                         "n = ActivePresentation.Slides.Count" \
                         "For i = n To 1 Step -1" \
                         "Set s = ActivePresentation.Slides(i)" \
                         "If s.SlideShowTransition.Hidden = msoTrue Then" \
                         "s.SlideShowTransition.Hidden = msoFalse" \
                         "ElseIf Left$(s.Name, 13) = 'AutoGenerated' Then" \
                         "s.Delete" \
                         "End If" \
                         "Next" \
                         "End Sub"

    # Check if there is a VBA Macro
    if presentation.vba_project is not None:
        # If there is Macro, print each module
        for module in presentation.vba_project.modules:
            print("Module's name is ", module.name)
            print("Module's source codes are ", module.source_code)

    # Save Presentation
    presentation.save("add-vba-macro.pptx", slides.export.SaveFormat.PPTM)
```

## Convert PPT to PDF

```python
import aspose.slides as slides

pres = slides.Presentation('Presentation.pptx')
pres.save("pptx-to-pdf.pdf", slides.export.SaveFormat.PDF)
```
