# Convert PowerPoint to PDF with Animations
## Macro Code
```vim
Option Explicit

Sub AddElements()
Dim shp As Shape

Dim i As Integer, n As Integer
n = ActivePresentation.Slides.Count
For i = 1 To n
    Dim s As Slide
    Set s = ActivePresentation.Slides(i)
    s.SlideShowTransition.Hidden = msoTrue
    
    Dim max As Integer: max = AnimationElements(s)
    Dim k As Integer, s2 As Slide
    For k = 1 To max
        Set s2 = s.Duplicate(1)
        s2.Name = "AutoGenerated: " & s2.SlideID
        s2.SlideShowTransition.Hidden = msoFalse
        
        Dim oshp As Shape
        With s2.Shapes
            Set oshp = .AddTextbox(msoTextOrientationHorizontal, 905, 510, 100, 50)
            oshp.TextFrame.TextRange.Font.Name = "Times New Roman"
            oshp.TextFrame.TextRange.Font.Size = 12
            oshp.TextFrame.TextRange.InsertAfter "" & i
        End With
        
        s2.MoveTo ActivePresentation.Slides.Count
        
        Dim i2 As Integer, h As Shape
        Dim Del As New Collection
        For i2 = s2.Shapes.Count To 1 Step -1
            Set h = s2.Shapes(i2)
            If Not IsVisible(s2, h, k) Then Del.Add h
        Next
        Dim j As Integer
        For j = s.TimeLine.MainSequence.Count To 1 Step -1
            s2.TimeLine.MainSequence.Item(1).Delete
        Next
        For j = Del.Count To 1 Step -1
            Del(j).Delete
            Del.Remove j
        Next
    Next
Next
End Sub

'is the shape on this slide visible at point this time step (1..n)
Function IsVisible(s As Slide, h As Shape, i As Integer) As Boolean

'first search for a start state
Dim e As Effect
IsVisible = True
For Each e In s.TimeLine.MainSequence
    If e.Shape Is h Then
        IsVisible = Not (e.Exit = msoFalse)
        Exit For
    End If
Next

'now run forward animating it
Dim n As Integer: n = 1
For Each e In s.TimeLine.MainSequence
    If e.Timing.TriggerType = msoAnimTriggerOnPageClick Then n = n + 1
    If n > i Then Exit For
    If e.Shape Is h Then IsVisible = (e.Exit = msoFalse)
Next
End Function

'How many animation steps are there
'1 for a slide with no additional elements
Function AnimationElements(s As Slide) As Integer
AnimationElements = 1
Dim e As Effect
For Each e In s.TimeLine.MainSequence
    If e.Timing.TriggerType = msoAnimTriggerOnPageClick Then
        AnimationElements = AnimationElements + 1
    End If
Next
End Function

Sub RemElements()
Dim i As Integer, n As Integer
Dim s As Slide
n = ActivePresentation.Slides.Count
For i = n To 1 Step -1
    Set s = ActivePresentation.Slides(i)
    If s.SlideShowTransition.Hidden = msoTrue Then
        s.SlideShowTransition.Hidden = msoFalse
    ElseIf Left$(s.Name, 13) = "AutoGenerated" Then
        s.Delete
    End If
Next
End Sub
```

## Tutorial 
### Convert PDF with Animations
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212064903-5120f20a-0b8c-4d4a-a056-9cb3be2ecb8b.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212065782-47dd8dba-89dc-48a8-8cc0-fa0902bd0534.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212066255-765d880b-41c7-4f4f-98b1-7d005708c090.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212066434-f14219db-a490-49b1-b7cb-077f0b409d6f.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212066892-8e4daa14-4e61-4ae9-be34-d2eab3a35afa.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212066967-eb16b904-e8f2-4e30-ba3f-91dd9b59a18c.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212070779-1934222d-49bd-4c3a-9750-d00c15358b0a.png">

### Recover Original PPT
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212067294-4ea9e50b-4d50-478c-991a-a7b4f92d18c3.png">
<img width="1680" alt="image" src="https://user-images.githubusercontent.com/31528604/212070823-cdf58705-c723-4c64-a35a-a4371d5a5e9a.png">
